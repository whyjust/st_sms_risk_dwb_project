
CREATE TABLE sms_bd_data.customer_test_offline_fin_loan_feature_2026011001 AS
WITH cus_sample AS (
    SELECT 
        mobile_md5,
        back_date
    FROM(
        -- 需要满足回溯日期
        -- back_date要求YYYYMMDD格式
        select
            phone as mobile_md5,
            substr(submitdate, 0, 10) as back_date
        from sms_bd_data.ods_yxx_spn_sms_detail_di
        where submitdate>='2025-08-20'
        limit 50000
    )smp
    group by mobile_md5, back_date
),customer_dwb_sms AS (
    select
        mobile_md5, 
        back_date, 
        sign, 
        event_time,
        event_type, 
        ind_tag
    from(
        select
            /*+ MAPJOIN(cus_smp) */
            cus_smp.mobile_md5,
            cus_smp.back_date,
            dwb_loan.sign,
            dwb_loan.event_type,
            dwb_loan.event_time,
            case when dwb_loan.sign regexp "抖音月付|放心借|微众银行|花呗" then 'indA'
                 when dwb_loan.sign regexp "美团月付|携程金融|360借|拍拍贷|分期乐|拍拍金融|360贷款|上海拍拍贷|美团金融服务" then 'indB'
                 when dwb_loan.sign regexp "还呗|信用飞钱包|省呗|乐享借|融360|洋钱罐借款|众安金融|分期金融|信用飞|乐逸花|极融借款|好分期|信用卡贷|金瀛分期|小赢卡贷|宜享花|众安贷借钱|融逸花|卡贷金融|吉用花|时光分期|小花钱包|借钱呗|金豆花|信用飞金融|来分期|小花借款|好会借|乐贷分期|及贷|榕树贷款|融易分期|借小花|薇钱包|你我贷|玖富借条" then 'indC'
                 when dwb_loan.sign regexp "金融调解|数科金融|满松科技|利信普惠|普信金融|卡卡金融|和信普惠|和信金融|利信金融|数信普惠|普惠快信|普惠信息|首山金融|普惠金融|数信普惠|玖富万卡|钱站|鹰潭市金融纠纷调解中心|国美易卡|普惠分期|上海金融|数科纠纷调解中心" or sign in ('玖富') then 'indD'
                 when dwb_loan.sign regexp "消费分期|消费金融|招联金融|移动白条|捷信金融|马上金融|中原消费金融|马上消费|分期消费" then 'indE'
                 when dwb_loan.sign regexp "银行|农信|农商" then 'indF'
            else 'indG' end as ind_tag
        from cus_sample cus_smp
        left join(
            select
                phone,
                sign,
                event_type,
                from_unixtime(unix_timestamp(the_date, 'yyyyMMdd'), 'yyyy-MM-dd') as event_time
            from sms_bd_data.sms_dwb_fin_loan_event_fdt
        )dwb_loan
        on cus_smp.mobile_md5=dwb_loan.phone 
        where cus_smp.back_date > dwb_loan.event_time and dwb_loan.event_time >= date_sub(cus_smp.back_date, 360)
    )cus_dwb
    group by mobile_md5, back_date, sign, event_type, event_time, ind_tag
),pre_distinct AS (
    SELECT
        mobile_md5,
        back_date,
        sign,
        event_type,
        ind_tag,
        event_time,
        CASE WHEN datediff(back_date, event_time) > 0 AND datediff(back_date, event_time) <= 15 THEN 1 ELSE 0 END as flag_15d,
        CASE WHEN datediff(back_date, event_time) > 0 AND datediff(back_date, event_time) <= 30 THEN 1 ELSE 0 END as flag_30d,
        CASE WHEN datediff(back_date, event_time) > 0 AND datediff(back_date, event_time) <= 60 THEN 1 ELSE 0 END as flag_60d,
        CASE WHEN datediff(back_date, event_time) > 0 AND datediff(back_date, event_time) <= 90 THEN 1 ELSE 0 END as flag_90d,
        CASE WHEN datediff(back_date, event_time) > 0 AND datediff(back_date, event_time) <= 180 THEN 1 ELSE 0 END as flag_180d,
        CASE WHEN datediff(back_date, event_time) > 0 AND datediff(back_date, event_time) <= 360 THEN 1 ELSE 0 END as flag_360d
    FROM customer_dwb_sms
    WHERE sign IS NOT NULL 
    -- 提前按核心维度去重，后续无需重复distinct
    GROUP BY mobile_md5, back_date, sign, event_type, ind_tag, event_time
),plat_cnt_stats AS (
    SELECT
        mobile_md5,
        back_date,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 THEN sign END) AS sp_fin_loan_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 THEN sign END) AS sp_fin_loan_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 THEN sign END) AS sp_fin_loan_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 THEN sign END) AS sp_fin_loan_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 THEN sign END) AS sp_fin_loan_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 THEN sign END) AS sp_fin_loan_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B01' THEN sign END) AS sp_fin_loan_event_b01_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B02' THEN sign END) AS sp_fin_loan_event_b02_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B03' THEN sign END) AS sp_fin_loan_event_b03_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B04' THEN sign END) AS sp_fin_loan_event_b04_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B05' THEN sign END) AS sp_fin_loan_event_b05_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B06' THEN sign END) AS sp_fin_loan_event_b06_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B07' THEN sign END) AS sp_fin_loan_event_b07_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B08' THEN sign END) AS sp_fin_loan_event_b08_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B09' THEN sign END) AS sp_fin_loan_event_b09_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND event_type='B10' THEN sign END) AS sp_fin_loan_event_b10_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B01' THEN sign END) AS sp_fin_loan_event_b01_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B02' THEN sign END) AS sp_fin_loan_event_b02_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B03' THEN sign END) AS sp_fin_loan_event_b03_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B04' THEN sign END) AS sp_fin_loan_event_b04_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B05' THEN sign END) AS sp_fin_loan_event_b05_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B06' THEN sign END) AS sp_fin_loan_event_b06_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B07' THEN sign END) AS sp_fin_loan_event_b07_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B08' THEN sign END) AS sp_fin_loan_event_b08_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B09' THEN sign END) AS sp_fin_loan_event_b09_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND event_type='B10' THEN sign END) AS sp_fin_loan_event_b10_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B01' THEN sign END) AS sp_fin_loan_event_b01_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B02' THEN sign END) AS sp_fin_loan_event_b02_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B03' THEN sign END) AS sp_fin_loan_event_b03_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B04' THEN sign END) AS sp_fin_loan_event_b04_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B05' THEN sign END) AS sp_fin_loan_event_b05_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B06' THEN sign END) AS sp_fin_loan_event_b06_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B07' THEN sign END) AS sp_fin_loan_event_b07_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B08' THEN sign END) AS sp_fin_loan_event_b08_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B09' THEN sign END) AS sp_fin_loan_event_b09_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND event_type='B10' THEN sign END) AS sp_fin_loan_event_b10_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B01' THEN sign END) AS sp_fin_loan_event_b01_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B02' THEN sign END) AS sp_fin_loan_event_b02_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B03' THEN sign END) AS sp_fin_loan_event_b03_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B04' THEN sign END) AS sp_fin_loan_event_b04_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B05' THEN sign END) AS sp_fin_loan_event_b05_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B06' THEN sign END) AS sp_fin_loan_event_b06_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B07' THEN sign END) AS sp_fin_loan_event_b07_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B08' THEN sign END) AS sp_fin_loan_event_b08_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B09' THEN sign END) AS sp_fin_loan_event_b09_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND event_type='B10' THEN sign END) AS sp_fin_loan_event_b10_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B01' THEN sign END) AS sp_fin_loan_event_b01_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B02' THEN sign END) AS sp_fin_loan_event_b02_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B03' THEN sign END) AS sp_fin_loan_event_b03_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B04' THEN sign END) AS sp_fin_loan_event_b04_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B05' THEN sign END) AS sp_fin_loan_event_b05_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B06' THEN sign END) AS sp_fin_loan_event_b06_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B07' THEN sign END) AS sp_fin_loan_event_b07_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B08' THEN sign END) AS sp_fin_loan_event_b08_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B09' THEN sign END) AS sp_fin_loan_event_b09_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND event_type='B10' THEN sign END) AS sp_fin_loan_event_b10_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B01' THEN sign END) AS sp_fin_loan_event_b01_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B02' THEN sign END) AS sp_fin_loan_event_b02_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B03' THEN sign END) AS sp_fin_loan_event_b03_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B04' THEN sign END) AS sp_fin_loan_event_b04_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B05' THEN sign END) AS sp_fin_loan_event_b05_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B06' THEN sign END) AS sp_fin_loan_event_b06_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B07' THEN sign END) AS sp_fin_loan_event_b07_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B08' THEN sign END) AS sp_fin_loan_event_b08_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B09' THEN sign END) AS sp_fin_loan_event_b09_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND event_type='B10' THEN sign END) AS sp_fin_loan_event_b10_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B01' THEN sign END) AS sp_fin_loan_inda_event_b01_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B02' THEN sign END) AS sp_fin_loan_inda_event_b02_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B03' THEN sign END) AS sp_fin_loan_inda_event_b03_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B04' THEN sign END) AS sp_fin_loan_inda_event_b04_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B05' THEN sign END) AS sp_fin_loan_inda_event_b05_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B06' THEN sign END) AS sp_fin_loan_inda_event_b06_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B07' THEN sign END) AS sp_fin_loan_inda_event_b07_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B08' THEN sign END) AS sp_fin_loan_inda_event_b08_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B09' THEN sign END) AS sp_fin_loan_inda_event_b09_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B10' THEN sign END) AS sp_fin_loan_inda_event_b10_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B01' THEN sign END) AS sp_fin_loan_indb_event_b01_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B02' THEN sign END) AS sp_fin_loan_indb_event_b02_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B03' THEN sign END) AS sp_fin_loan_indb_event_b03_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B04' THEN sign END) AS sp_fin_loan_indb_event_b04_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B05' THEN sign END) AS sp_fin_loan_indb_event_b05_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B06' THEN sign END) AS sp_fin_loan_indb_event_b06_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B07' THEN sign END) AS sp_fin_loan_indb_event_b07_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B08' THEN sign END) AS sp_fin_loan_indb_event_b08_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B09' THEN sign END) AS sp_fin_loan_indb_event_b09_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B10' THEN sign END) AS sp_fin_loan_indb_event_b10_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B01' THEN sign END) AS sp_fin_loan_indc_event_b01_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B02' THEN sign END) AS sp_fin_loan_indc_event_b02_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B03' THEN sign END) AS sp_fin_loan_indc_event_b03_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B04' THEN sign END) AS sp_fin_loan_indc_event_b04_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B05' THEN sign END) AS sp_fin_loan_indc_event_b05_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B06' THEN sign END) AS sp_fin_loan_indc_event_b06_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B07' THEN sign END) AS sp_fin_loan_indc_event_b07_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B08' THEN sign END) AS sp_fin_loan_indc_event_b08_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B09' THEN sign END) AS sp_fin_loan_indc_event_b09_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B10' THEN sign END) AS sp_fin_loan_indc_event_b10_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B01' THEN sign END) AS sp_fin_loan_inde_event_b01_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B02' THEN sign END) AS sp_fin_loan_inde_event_b02_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B03' THEN sign END) AS sp_fin_loan_inde_event_b03_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B04' THEN sign END) AS sp_fin_loan_inde_event_b04_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B05' THEN sign END) AS sp_fin_loan_inde_event_b05_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B06' THEN sign END) AS sp_fin_loan_inde_event_b06_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B07' THEN sign END) AS sp_fin_loan_inde_event_b07_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B08' THEN sign END) AS sp_fin_loan_inde_event_b08_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B09' THEN sign END) AS sp_fin_loan_inde_event_b09_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B10' THEN sign END) AS sp_fin_loan_inde_event_b10_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B01' THEN sign END) AS sp_fin_loan_indf_event_b01_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B02' THEN sign END) AS sp_fin_loan_indf_event_b02_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B03' THEN sign END) AS sp_fin_loan_indf_event_b03_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B04' THEN sign END) AS sp_fin_loan_indf_event_b04_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B05' THEN sign END) AS sp_fin_loan_indf_event_b05_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B06' THEN sign END) AS sp_fin_loan_indf_event_b06_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B07' THEN sign END) AS sp_fin_loan_indf_event_b07_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B08' THEN sign END) AS sp_fin_loan_indf_event_b08_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B09' THEN sign END) AS sp_fin_loan_indf_event_b09_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B10' THEN sign END) AS sp_fin_loan_indf_event_b10_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B01' THEN sign END) AS sp_fin_loan_indg_event_b01_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B02' THEN sign END) AS sp_fin_loan_indg_event_b02_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B03' THEN sign END) AS sp_fin_loan_indg_event_b03_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B04' THEN sign END) AS sp_fin_loan_indg_event_b04_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B05' THEN sign END) AS sp_fin_loan_indg_event_b05_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B06' THEN sign END) AS sp_fin_loan_indg_event_b06_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B07' THEN sign END) AS sp_fin_loan_indg_event_b07_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B08' THEN sign END) AS sp_fin_loan_indg_event_b08_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B09' THEN sign END) AS sp_fin_loan_indg_event_b09_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B10' THEN sign END) AS sp_fin_loan_indg_event_b10_plat_cnt_15d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B01' THEN sign END) AS sp_fin_loan_inda_event_b01_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B02' THEN sign END) AS sp_fin_loan_inda_event_b02_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B03' THEN sign END) AS sp_fin_loan_inda_event_b03_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B04' THEN sign END) AS sp_fin_loan_inda_event_b04_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B05' THEN sign END) AS sp_fin_loan_inda_event_b05_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B06' THEN sign END) AS sp_fin_loan_inda_event_b06_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B07' THEN sign END) AS sp_fin_loan_inda_event_b07_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B08' THEN sign END) AS sp_fin_loan_inda_event_b08_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B09' THEN sign END) AS sp_fin_loan_inda_event_b09_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B10' THEN sign END) AS sp_fin_loan_inda_event_b10_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B01' THEN sign END) AS sp_fin_loan_indb_event_b01_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B02' THEN sign END) AS sp_fin_loan_indb_event_b02_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B03' THEN sign END) AS sp_fin_loan_indb_event_b03_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B04' THEN sign END) AS sp_fin_loan_indb_event_b04_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B05' THEN sign END) AS sp_fin_loan_indb_event_b05_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B06' THEN sign END) AS sp_fin_loan_indb_event_b06_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B07' THEN sign END) AS sp_fin_loan_indb_event_b07_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B08' THEN sign END) AS sp_fin_loan_indb_event_b08_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B09' THEN sign END) AS sp_fin_loan_indb_event_b09_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B10' THEN sign END) AS sp_fin_loan_indb_event_b10_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B01' THEN sign END) AS sp_fin_loan_indc_event_b01_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B02' THEN sign END) AS sp_fin_loan_indc_event_b02_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B03' THEN sign END) AS sp_fin_loan_indc_event_b03_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B04' THEN sign END) AS sp_fin_loan_indc_event_b04_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B05' THEN sign END) AS sp_fin_loan_indc_event_b05_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B06' THEN sign END) AS sp_fin_loan_indc_event_b06_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B07' THEN sign END) AS sp_fin_loan_indc_event_b07_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B08' THEN sign END) AS sp_fin_loan_indc_event_b08_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B09' THEN sign END) AS sp_fin_loan_indc_event_b09_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B10' THEN sign END) AS sp_fin_loan_indc_event_b10_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B01' THEN sign END) AS sp_fin_loan_inde_event_b01_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B02' THEN sign END) AS sp_fin_loan_inde_event_b02_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B03' THEN sign END) AS sp_fin_loan_inde_event_b03_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B04' THEN sign END) AS sp_fin_loan_inde_event_b04_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B05' THEN sign END) AS sp_fin_loan_inde_event_b05_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B06' THEN sign END) AS sp_fin_loan_inde_event_b06_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B07' THEN sign END) AS sp_fin_loan_inde_event_b07_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B08' THEN sign END) AS sp_fin_loan_inde_event_b08_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B09' THEN sign END) AS sp_fin_loan_inde_event_b09_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B10' THEN sign END) AS sp_fin_loan_inde_event_b10_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B01' THEN sign END) AS sp_fin_loan_indf_event_b01_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B02' THEN sign END) AS sp_fin_loan_indf_event_b02_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B03' THEN sign END) AS sp_fin_loan_indf_event_b03_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B04' THEN sign END) AS sp_fin_loan_indf_event_b04_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B05' THEN sign END) AS sp_fin_loan_indf_event_b05_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B06' THEN sign END) AS sp_fin_loan_indf_event_b06_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B07' THEN sign END) AS sp_fin_loan_indf_event_b07_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B08' THEN sign END) AS sp_fin_loan_indf_event_b08_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B09' THEN sign END) AS sp_fin_loan_indf_event_b09_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B10' THEN sign END) AS sp_fin_loan_indf_event_b10_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B01' THEN sign END) AS sp_fin_loan_indg_event_b01_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B02' THEN sign END) AS sp_fin_loan_indg_event_b02_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B03' THEN sign END) AS sp_fin_loan_indg_event_b03_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B04' THEN sign END) AS sp_fin_loan_indg_event_b04_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B05' THEN sign END) AS sp_fin_loan_indg_event_b05_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B06' THEN sign END) AS sp_fin_loan_indg_event_b06_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B07' THEN sign END) AS sp_fin_loan_indg_event_b07_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B08' THEN sign END) AS sp_fin_loan_indg_event_b08_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B09' THEN sign END) AS sp_fin_loan_indg_event_b09_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B10' THEN sign END) AS sp_fin_loan_indg_event_b10_plat_cnt_30d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B01' THEN sign END) AS sp_fin_loan_inda_event_b01_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B02' THEN sign END) AS sp_fin_loan_inda_event_b02_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B03' THEN sign END) AS sp_fin_loan_inda_event_b03_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B04' THEN sign END) AS sp_fin_loan_inda_event_b04_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B05' THEN sign END) AS sp_fin_loan_inda_event_b05_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B06' THEN sign END) AS sp_fin_loan_inda_event_b06_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B07' THEN sign END) AS sp_fin_loan_inda_event_b07_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B08' THEN sign END) AS sp_fin_loan_inda_event_b08_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B09' THEN sign END) AS sp_fin_loan_inda_event_b09_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B10' THEN sign END) AS sp_fin_loan_inda_event_b10_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B01' THEN sign END) AS sp_fin_loan_indb_event_b01_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B02' THEN sign END) AS sp_fin_loan_indb_event_b02_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B03' THEN sign END) AS sp_fin_loan_indb_event_b03_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B04' THEN sign END) AS sp_fin_loan_indb_event_b04_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B05' THEN sign END) AS sp_fin_loan_indb_event_b05_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B06' THEN sign END) AS sp_fin_loan_indb_event_b06_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B07' THEN sign END) AS sp_fin_loan_indb_event_b07_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B08' THEN sign END) AS sp_fin_loan_indb_event_b08_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B09' THEN sign END) AS sp_fin_loan_indb_event_b09_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B10' THEN sign END) AS sp_fin_loan_indb_event_b10_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B01' THEN sign END) AS sp_fin_loan_indc_event_b01_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B02' THEN sign END) AS sp_fin_loan_indc_event_b02_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B03' THEN sign END) AS sp_fin_loan_indc_event_b03_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B04' THEN sign END) AS sp_fin_loan_indc_event_b04_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B05' THEN sign END) AS sp_fin_loan_indc_event_b05_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B06' THEN sign END) AS sp_fin_loan_indc_event_b06_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B07' THEN sign END) AS sp_fin_loan_indc_event_b07_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B08' THEN sign END) AS sp_fin_loan_indc_event_b08_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B09' THEN sign END) AS sp_fin_loan_indc_event_b09_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B10' THEN sign END) AS sp_fin_loan_indc_event_b10_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B01' THEN sign END) AS sp_fin_loan_inde_event_b01_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B02' THEN sign END) AS sp_fin_loan_inde_event_b02_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B03' THEN sign END) AS sp_fin_loan_inde_event_b03_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B04' THEN sign END) AS sp_fin_loan_inde_event_b04_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B05' THEN sign END) AS sp_fin_loan_inde_event_b05_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B06' THEN sign END) AS sp_fin_loan_inde_event_b06_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B07' THEN sign END) AS sp_fin_loan_inde_event_b07_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B08' THEN sign END) AS sp_fin_loan_inde_event_b08_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B09' THEN sign END) AS sp_fin_loan_inde_event_b09_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B10' THEN sign END) AS sp_fin_loan_inde_event_b10_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B01' THEN sign END) AS sp_fin_loan_indf_event_b01_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B02' THEN sign END) AS sp_fin_loan_indf_event_b02_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B03' THEN sign END) AS sp_fin_loan_indf_event_b03_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B04' THEN sign END) AS sp_fin_loan_indf_event_b04_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B05' THEN sign END) AS sp_fin_loan_indf_event_b05_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B06' THEN sign END) AS sp_fin_loan_indf_event_b06_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B07' THEN sign END) AS sp_fin_loan_indf_event_b07_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B08' THEN sign END) AS sp_fin_loan_indf_event_b08_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B09' THEN sign END) AS sp_fin_loan_indf_event_b09_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B10' THEN sign END) AS sp_fin_loan_indf_event_b10_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B01' THEN sign END) AS sp_fin_loan_indg_event_b01_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B02' THEN sign END) AS sp_fin_loan_indg_event_b02_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B03' THEN sign END) AS sp_fin_loan_indg_event_b03_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B04' THEN sign END) AS sp_fin_loan_indg_event_b04_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B05' THEN sign END) AS sp_fin_loan_indg_event_b05_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B06' THEN sign END) AS sp_fin_loan_indg_event_b06_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B07' THEN sign END) AS sp_fin_loan_indg_event_b07_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B08' THEN sign END) AS sp_fin_loan_indg_event_b08_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B09' THEN sign END) AS sp_fin_loan_indg_event_b09_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B10' THEN sign END) AS sp_fin_loan_indg_event_b10_plat_cnt_60d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B01' THEN sign END) AS sp_fin_loan_inda_event_b01_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B02' THEN sign END) AS sp_fin_loan_inda_event_b02_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B03' THEN sign END) AS sp_fin_loan_inda_event_b03_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B04' THEN sign END) AS sp_fin_loan_inda_event_b04_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B05' THEN sign END) AS sp_fin_loan_inda_event_b05_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B06' THEN sign END) AS sp_fin_loan_inda_event_b06_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B07' THEN sign END) AS sp_fin_loan_inda_event_b07_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B08' THEN sign END) AS sp_fin_loan_inda_event_b08_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B09' THEN sign END) AS sp_fin_loan_inda_event_b09_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B10' THEN sign END) AS sp_fin_loan_inda_event_b10_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B01' THEN sign END) AS sp_fin_loan_indb_event_b01_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B02' THEN sign END) AS sp_fin_loan_indb_event_b02_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B03' THEN sign END) AS sp_fin_loan_indb_event_b03_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B04' THEN sign END) AS sp_fin_loan_indb_event_b04_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B05' THEN sign END) AS sp_fin_loan_indb_event_b05_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B06' THEN sign END) AS sp_fin_loan_indb_event_b06_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B07' THEN sign END) AS sp_fin_loan_indb_event_b07_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B08' THEN sign END) AS sp_fin_loan_indb_event_b08_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B09' THEN sign END) AS sp_fin_loan_indb_event_b09_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B10' THEN sign END) AS sp_fin_loan_indb_event_b10_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B01' THEN sign END) AS sp_fin_loan_indc_event_b01_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B02' THEN sign END) AS sp_fin_loan_indc_event_b02_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B03' THEN sign END) AS sp_fin_loan_indc_event_b03_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B04' THEN sign END) AS sp_fin_loan_indc_event_b04_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B05' THEN sign END) AS sp_fin_loan_indc_event_b05_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B06' THEN sign END) AS sp_fin_loan_indc_event_b06_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B07' THEN sign END) AS sp_fin_loan_indc_event_b07_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B08' THEN sign END) AS sp_fin_loan_indc_event_b08_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B09' THEN sign END) AS sp_fin_loan_indc_event_b09_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B10' THEN sign END) AS sp_fin_loan_indc_event_b10_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B01' THEN sign END) AS sp_fin_loan_inde_event_b01_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B02' THEN sign END) AS sp_fin_loan_inde_event_b02_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B03' THEN sign END) AS sp_fin_loan_inde_event_b03_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B04' THEN sign END) AS sp_fin_loan_inde_event_b04_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B05' THEN sign END) AS sp_fin_loan_inde_event_b05_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B06' THEN sign END) AS sp_fin_loan_inde_event_b06_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B07' THEN sign END) AS sp_fin_loan_inde_event_b07_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B08' THEN sign END) AS sp_fin_loan_inde_event_b08_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B09' THEN sign END) AS sp_fin_loan_inde_event_b09_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B10' THEN sign END) AS sp_fin_loan_inde_event_b10_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B01' THEN sign END) AS sp_fin_loan_indf_event_b01_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B02' THEN sign END) AS sp_fin_loan_indf_event_b02_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B03' THEN sign END) AS sp_fin_loan_indf_event_b03_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B04' THEN sign END) AS sp_fin_loan_indf_event_b04_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B05' THEN sign END) AS sp_fin_loan_indf_event_b05_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B06' THEN sign END) AS sp_fin_loan_indf_event_b06_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B07' THEN sign END) AS sp_fin_loan_indf_event_b07_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B08' THEN sign END) AS sp_fin_loan_indf_event_b08_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B09' THEN sign END) AS sp_fin_loan_indf_event_b09_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B10' THEN sign END) AS sp_fin_loan_indf_event_b10_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B01' THEN sign END) AS sp_fin_loan_indg_event_b01_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B02' THEN sign END) AS sp_fin_loan_indg_event_b02_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B03' THEN sign END) AS sp_fin_loan_indg_event_b03_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B04' THEN sign END) AS sp_fin_loan_indg_event_b04_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B05' THEN sign END) AS sp_fin_loan_indg_event_b05_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B06' THEN sign END) AS sp_fin_loan_indg_event_b06_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B07' THEN sign END) AS sp_fin_loan_indg_event_b07_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B08' THEN sign END) AS sp_fin_loan_indg_event_b08_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B09' THEN sign END) AS sp_fin_loan_indg_event_b09_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B10' THEN sign END) AS sp_fin_loan_indg_event_b10_plat_cnt_90d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B01' THEN sign END) AS sp_fin_loan_inda_event_b01_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B02' THEN sign END) AS sp_fin_loan_inda_event_b02_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B03' THEN sign END) AS sp_fin_loan_inda_event_b03_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B04' THEN sign END) AS sp_fin_loan_inda_event_b04_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B05' THEN sign END) AS sp_fin_loan_inda_event_b05_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B06' THEN sign END) AS sp_fin_loan_inda_event_b06_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B07' THEN sign END) AS sp_fin_loan_inda_event_b07_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B08' THEN sign END) AS sp_fin_loan_inda_event_b08_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B09' THEN sign END) AS sp_fin_loan_inda_event_b09_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B10' THEN sign END) AS sp_fin_loan_inda_event_b10_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B01' THEN sign END) AS sp_fin_loan_indb_event_b01_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B02' THEN sign END) AS sp_fin_loan_indb_event_b02_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B03' THEN sign END) AS sp_fin_loan_indb_event_b03_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B04' THEN sign END) AS sp_fin_loan_indb_event_b04_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B05' THEN sign END) AS sp_fin_loan_indb_event_b05_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B06' THEN sign END) AS sp_fin_loan_indb_event_b06_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B07' THEN sign END) AS sp_fin_loan_indb_event_b07_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B08' THEN sign END) AS sp_fin_loan_indb_event_b08_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B09' THEN sign END) AS sp_fin_loan_indb_event_b09_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B10' THEN sign END) AS sp_fin_loan_indb_event_b10_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B01' THEN sign END) AS sp_fin_loan_indc_event_b01_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B02' THEN sign END) AS sp_fin_loan_indc_event_b02_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B03' THEN sign END) AS sp_fin_loan_indc_event_b03_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B04' THEN sign END) AS sp_fin_loan_indc_event_b04_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B05' THEN sign END) AS sp_fin_loan_indc_event_b05_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B06' THEN sign END) AS sp_fin_loan_indc_event_b06_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B07' THEN sign END) AS sp_fin_loan_indc_event_b07_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B08' THEN sign END) AS sp_fin_loan_indc_event_b08_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B09' THEN sign END) AS sp_fin_loan_indc_event_b09_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B10' THEN sign END) AS sp_fin_loan_indc_event_b10_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B01' THEN sign END) AS sp_fin_loan_inde_event_b01_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B02' THEN sign END) AS sp_fin_loan_inde_event_b02_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B03' THEN sign END) AS sp_fin_loan_inde_event_b03_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B04' THEN sign END) AS sp_fin_loan_inde_event_b04_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B05' THEN sign END) AS sp_fin_loan_inde_event_b05_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B06' THEN sign END) AS sp_fin_loan_inde_event_b06_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B07' THEN sign END) AS sp_fin_loan_inde_event_b07_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B08' THEN sign END) AS sp_fin_loan_inde_event_b08_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B09' THEN sign END) AS sp_fin_loan_inde_event_b09_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B10' THEN sign END) AS sp_fin_loan_inde_event_b10_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B01' THEN sign END) AS sp_fin_loan_indf_event_b01_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B02' THEN sign END) AS sp_fin_loan_indf_event_b02_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B03' THEN sign END) AS sp_fin_loan_indf_event_b03_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B04' THEN sign END) AS sp_fin_loan_indf_event_b04_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B05' THEN sign END) AS sp_fin_loan_indf_event_b05_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B06' THEN sign END) AS sp_fin_loan_indf_event_b06_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B07' THEN sign END) AS sp_fin_loan_indf_event_b07_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B08' THEN sign END) AS sp_fin_loan_indf_event_b08_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B09' THEN sign END) AS sp_fin_loan_indf_event_b09_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B10' THEN sign END) AS sp_fin_loan_indf_event_b10_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B01' THEN sign END) AS sp_fin_loan_indg_event_b01_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B02' THEN sign END) AS sp_fin_loan_indg_event_b02_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B03' THEN sign END) AS sp_fin_loan_indg_event_b03_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B04' THEN sign END) AS sp_fin_loan_indg_event_b04_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B05' THEN sign END) AS sp_fin_loan_indg_event_b05_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B06' THEN sign END) AS sp_fin_loan_indg_event_b06_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B07' THEN sign END) AS sp_fin_loan_indg_event_b07_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B08' THEN sign END) AS sp_fin_loan_indg_event_b08_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B09' THEN sign END) AS sp_fin_loan_indg_event_b09_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B10' THEN sign END) AS sp_fin_loan_indg_event_b10_plat_cnt_180d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B01' THEN sign END) AS sp_fin_loan_inda_event_b01_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B02' THEN sign END) AS sp_fin_loan_inda_event_b02_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B03' THEN sign END) AS sp_fin_loan_inda_event_b03_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B04' THEN sign END) AS sp_fin_loan_inda_event_b04_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B05' THEN sign END) AS sp_fin_loan_inda_event_b05_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B06' THEN sign END) AS sp_fin_loan_inda_event_b06_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B07' THEN sign END) AS sp_fin_loan_inda_event_b07_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B08' THEN sign END) AS sp_fin_loan_inda_event_b08_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B09' THEN sign END) AS sp_fin_loan_inda_event_b09_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B10' THEN sign END) AS sp_fin_loan_inda_event_b10_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B01' THEN sign END) AS sp_fin_loan_indb_event_b01_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B02' THEN sign END) AS sp_fin_loan_indb_event_b02_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B03' THEN sign END) AS sp_fin_loan_indb_event_b03_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B04' THEN sign END) AS sp_fin_loan_indb_event_b04_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B05' THEN sign END) AS sp_fin_loan_indb_event_b05_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B06' THEN sign END) AS sp_fin_loan_indb_event_b06_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B07' THEN sign END) AS sp_fin_loan_indb_event_b07_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B08' THEN sign END) AS sp_fin_loan_indb_event_b08_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B09' THEN sign END) AS sp_fin_loan_indb_event_b09_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B10' THEN sign END) AS sp_fin_loan_indb_event_b10_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B01' THEN sign END) AS sp_fin_loan_indc_event_b01_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B02' THEN sign END) AS sp_fin_loan_indc_event_b02_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B03' THEN sign END) AS sp_fin_loan_indc_event_b03_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B04' THEN sign END) AS sp_fin_loan_indc_event_b04_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B05' THEN sign END) AS sp_fin_loan_indc_event_b05_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B06' THEN sign END) AS sp_fin_loan_indc_event_b06_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B07' THEN sign END) AS sp_fin_loan_indc_event_b07_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B08' THEN sign END) AS sp_fin_loan_indc_event_b08_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B09' THEN sign END) AS sp_fin_loan_indc_event_b09_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B10' THEN sign END) AS sp_fin_loan_indc_event_b10_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B01' THEN sign END) AS sp_fin_loan_inde_event_b01_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B02' THEN sign END) AS sp_fin_loan_inde_event_b02_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B03' THEN sign END) AS sp_fin_loan_inde_event_b03_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B04' THEN sign END) AS sp_fin_loan_inde_event_b04_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B05' THEN sign END) AS sp_fin_loan_inde_event_b05_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B06' THEN sign END) AS sp_fin_loan_inde_event_b06_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B07' THEN sign END) AS sp_fin_loan_inde_event_b07_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B08' THEN sign END) AS sp_fin_loan_inde_event_b08_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B09' THEN sign END) AS sp_fin_loan_inde_event_b09_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B10' THEN sign END) AS sp_fin_loan_inde_event_b10_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B01' THEN sign END) AS sp_fin_loan_indf_event_b01_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B02' THEN sign END) AS sp_fin_loan_indf_event_b02_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B03' THEN sign END) AS sp_fin_loan_indf_event_b03_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B04' THEN sign END) AS sp_fin_loan_indf_event_b04_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B05' THEN sign END) AS sp_fin_loan_indf_event_b05_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B06' THEN sign END) AS sp_fin_loan_indf_event_b06_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B07' THEN sign END) AS sp_fin_loan_indf_event_b07_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B08' THEN sign END) AS sp_fin_loan_indf_event_b08_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B09' THEN sign END) AS sp_fin_loan_indf_event_b09_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B10' THEN sign END) AS sp_fin_loan_indf_event_b10_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B01' THEN sign END) AS sp_fin_loan_indg_event_b01_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B02' THEN sign END) AS sp_fin_loan_indg_event_b02_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B03' THEN sign END) AS sp_fin_loan_indg_event_b03_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B04' THEN sign END) AS sp_fin_loan_indg_event_b04_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B05' THEN sign END) AS sp_fin_loan_indg_event_b05_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B06' THEN sign END) AS sp_fin_loan_indg_event_b06_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B07' THEN sign END) AS sp_fin_loan_indg_event_b07_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B08' THEN sign END) AS sp_fin_loan_indg_event_b08_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B09' THEN sign END) AS sp_fin_loan_indg_event_b09_plat_cnt_360d,
        COUNT(DISTINCT CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B10' THEN sign END) AS sp_fin_loan_indg_event_b10_plat_cnt_360d
    FROM pre_distinct
    GROUP BY mobile_md5, back_date
),event_stats AS (
    SELECT
        mobile_md5,
        back_date,
        SUM(flag_15d) AS sp_fin_loan_total_times_15d,
        SUM(flag_30d) AS sp_fin_loan_total_times_30d,
        SUM(flag_60d) AS sp_fin_loan_total_times_60d,
        SUM(flag_90d) AS sp_fin_loan_total_times_90d,
        SUM(flag_180d) AS sp_fin_loan_total_times_180d,
        SUM(flag_360d) AS sp_fin_loan_total_times_360d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indD' THEN 1 ELSE 0 END) AS sp_fin_loan_indd_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_times_15d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indD' THEN 1 ELSE 0 END) AS sp_fin_loan_indd_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_times_30d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indD' THEN 1 ELSE 0 END) AS sp_fin_loan_indd_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_times_60d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indD' THEN 1 ELSE 0 END) AS sp_fin_loan_indd_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_times_90d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indD' THEN 1 ELSE 0 END) AS sp_fin_loan_indd_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_times_180d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indD' THEN 1 ELSE 0 END) AS sp_fin_loan_indd_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_times_360d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b01_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b02_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b03_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b04_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b05_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b06_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b07_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b08_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b09_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b10_times_15d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b01_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b02_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b03_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b04_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b05_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b06_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b07_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b08_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b09_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b10_times_30d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b01_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b02_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b03_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b04_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b05_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b06_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b07_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b08_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b09_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b10_times_60d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b01_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b02_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b03_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b04_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b05_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b06_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b07_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b08_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b09_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b10_times_90d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b01_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b02_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b03_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b04_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b05_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b06_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b07_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b08_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b09_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b10_times_180d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b01_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b02_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b03_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b04_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b05_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b06_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b07_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b08_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b09_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_event_b10_times_360d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b01_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b02_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b03_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b04_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b05_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b06_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b07_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b08_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b09_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indA' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b10_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b01_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b02_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b03_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b04_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b05_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b06_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b07_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b08_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b09_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indB' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b10_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b01_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b02_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b03_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b04_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b05_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b06_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b07_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b08_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b09_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indC' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b10_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b01_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b02_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b03_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b04_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b05_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b06_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b07_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b08_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b09_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indE' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b10_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b01_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b02_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b03_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b04_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b05_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b06_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b07_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b08_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b09_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indF' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b10_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b01_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b02_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b03_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b04_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b05_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b06_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b07_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b08_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b09_times_15d,
        SUM(CASE WHEN flag_15d = 1 AND ind_tag='indG' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b10_times_15d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b01_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b02_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b03_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b04_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b05_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b06_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b07_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b08_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b09_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indA' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b10_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b01_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b02_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b03_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b04_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b05_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b06_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b07_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b08_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b09_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indB' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b10_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b01_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b02_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b03_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b04_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b05_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b06_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b07_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b08_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b09_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indC' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b10_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b01_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b02_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b03_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b04_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b05_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b06_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b07_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b08_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b09_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indE' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b10_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b01_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b02_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b03_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b04_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b05_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b06_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b07_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b08_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b09_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indF' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b10_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b01_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b02_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b03_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b04_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b05_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b06_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b07_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b08_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b09_times_30d,
        SUM(CASE WHEN flag_30d = 1 AND ind_tag='indG' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b10_times_30d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b01_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b02_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b03_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b04_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b05_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b06_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b07_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b08_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b09_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indA' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b10_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b01_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b02_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b03_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b04_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b05_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b06_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b07_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b08_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b09_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indB' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b10_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b01_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b02_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b03_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b04_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b05_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b06_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b07_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b08_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b09_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indC' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b10_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b01_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b02_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b03_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b04_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b05_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b06_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b07_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b08_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b09_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indE' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b10_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b01_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b02_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b03_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b04_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b05_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b06_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b07_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b08_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b09_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indF' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b10_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b01_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b02_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b03_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b04_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b05_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b06_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b07_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b08_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b09_times_60d,
        SUM(CASE WHEN flag_60d = 1 AND ind_tag='indG' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b10_times_60d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b01_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b02_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b03_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b04_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b05_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b06_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b07_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b08_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b09_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indA' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b10_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b01_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b02_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b03_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b04_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b05_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b06_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b07_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b08_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b09_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indB' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b10_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b01_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b02_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b03_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b04_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b05_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b06_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b07_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b08_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b09_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indC' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b10_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b01_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b02_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b03_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b04_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b05_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b06_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b07_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b08_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b09_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indE' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b10_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b01_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b02_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b03_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b04_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b05_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b06_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b07_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b08_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b09_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indF' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b10_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b01_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b02_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b03_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b04_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b05_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b06_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b07_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b08_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b09_times_90d,
        SUM(CASE WHEN flag_90d = 1 AND ind_tag='indG' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b10_times_90d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b01_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b02_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b03_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b04_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b05_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b06_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b07_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b08_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b09_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indA' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b10_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b01_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b02_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b03_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b04_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b05_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b06_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b07_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b08_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b09_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indB' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b10_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b01_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b02_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b03_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b04_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b05_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b06_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b07_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b08_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b09_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indC' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b10_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b01_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b02_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b03_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b04_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b05_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b06_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b07_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b08_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b09_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indE' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b10_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b01_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b02_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b03_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b04_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b05_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b06_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b07_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b08_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b09_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indF' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b10_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b01_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b02_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b03_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b04_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b05_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b06_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b07_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b08_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b09_times_180d,
        SUM(CASE WHEN flag_180d = 1 AND ind_tag='indG' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b10_times_180d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b01_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b02_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b03_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b04_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b05_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b06_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b07_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b08_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b09_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inda_event_b10_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b01_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b02_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b03_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b04_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b05_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b06_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b07_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b08_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b09_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indb_event_b10_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b01_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b02_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b03_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b04_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b05_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b06_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b07_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b08_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b09_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indc_event_b10_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b01_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b02_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b03_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b04_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b05_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b06_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b07_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b08_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b09_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_inde_event_b10_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b01_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b02_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b03_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b04_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b05_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b06_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b07_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b08_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b09_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indf_event_b10_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B01' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b01_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B02' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b02_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B03' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b03_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B04' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b04_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B05' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b05_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B06' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b06_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B07' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b07_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B08' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b08_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B09' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b09_times_360d,
        SUM(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B10' THEN 1 ELSE 0 END) AS sp_fin_loan_indg_event_b10_times_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B01' THEN event_time END)) AS sp_fin_loan_event_b01_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B01' THEN event_time END)) AS sp_fin_loan_event_b01_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B02' THEN event_time END)) AS sp_fin_loan_event_b02_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B02' THEN event_time END)) AS sp_fin_loan_event_b02_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B03' THEN event_time END)) AS sp_fin_loan_event_b03_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B03' THEN event_time END)) AS sp_fin_loan_event_b03_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B04' THEN event_time END)) AS sp_fin_loan_event_b04_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B04' THEN event_time END)) AS sp_fin_loan_event_b04_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B05' THEN event_time END)) AS sp_fin_loan_event_b05_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B05' THEN event_time END)) AS sp_fin_loan_event_b05_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B06' THEN event_time END)) AS sp_fin_loan_event_b06_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B06' THEN event_time END)) AS sp_fin_loan_event_b06_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B07' THEN event_time END)) AS sp_fin_loan_event_b07_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B07' THEN event_time END)) AS sp_fin_loan_event_b07_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B08' THEN event_time END)) AS sp_fin_loan_event_b08_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B08' THEN event_time END)) AS sp_fin_loan_event_b08_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B09' THEN event_time END)) AS sp_fin_loan_event_b09_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B09' THEN event_time END)) AS sp_fin_loan_event_b09_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND event_type='B10' THEN event_time END)) AS sp_fin_loan_event_b10_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND event_type='B10' THEN event_time END)) AS sp_fin_loan_event_b10_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_inda_event_b01_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_inda_event_b01_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_inda_event_b02_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_inda_event_b02_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_inda_event_b03_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_inda_event_b03_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_inda_event_b04_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_inda_event_b04_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_inda_event_b05_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_inda_event_b05_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_inda_event_b06_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_inda_event_b06_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_inda_event_b07_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_inda_event_b07_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_inda_event_b08_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_inda_event_b08_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_inda_event_b09_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_inda_event_b09_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_inda_event_b10_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indA' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_inda_event_b10_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_indb_event_b01_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_indb_event_b01_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_indb_event_b02_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_indb_event_b02_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_indb_event_b03_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_indb_event_b03_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_indb_event_b04_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_indb_event_b04_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_indb_event_b05_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_indb_event_b05_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_indb_event_b06_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_indb_event_b06_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_indb_event_b07_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_indb_event_b07_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_indb_event_b08_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_indb_event_b08_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_indb_event_b09_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_indb_event_b09_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_indb_event_b10_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indB' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_indb_event_b10_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_indc_event_b01_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_indc_event_b01_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_indc_event_b02_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_indc_event_b02_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_indc_event_b03_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_indc_event_b03_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_indc_event_b04_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_indc_event_b04_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_indc_event_b05_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_indc_event_b05_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_indc_event_b06_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_indc_event_b06_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_indc_event_b07_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_indc_event_b07_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_indc_event_b08_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_indc_event_b08_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_indc_event_b09_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_indc_event_b09_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_indc_event_b10_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indC' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_indc_event_b10_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_inde_event_b01_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_inde_event_b01_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_inde_event_b02_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_inde_event_b02_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_inde_event_b03_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_inde_event_b03_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_inde_event_b04_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_inde_event_b04_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_inde_event_b05_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_inde_event_b05_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_inde_event_b06_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_inde_event_b06_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_inde_event_b07_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_inde_event_b07_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_inde_event_b08_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_inde_event_b08_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_inde_event_b09_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_inde_event_b09_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_inde_event_b10_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indE' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_inde_event_b10_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_indf_event_b01_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_indf_event_b01_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_indf_event_b02_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_indf_event_b02_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_indf_event_b03_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_indf_event_b03_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_indf_event_b04_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_indf_event_b04_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_indf_event_b05_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_indf_event_b05_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_indf_event_b06_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_indf_event_b06_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_indf_event_b07_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_indf_event_b07_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_indf_event_b08_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_indf_event_b08_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_indf_event_b09_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_indf_event_b09_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_indf_event_b10_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indF' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_indf_event_b10_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_indg_event_b01_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B01' THEN event_time END)) AS sp_fin_loan_indg_event_b01_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_indg_event_b02_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B02' THEN event_time END)) AS sp_fin_loan_indg_event_b02_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_indg_event_b03_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B03' THEN event_time END)) AS sp_fin_loan_indg_event_b03_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_indg_event_b04_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B04' THEN event_time END)) AS sp_fin_loan_indg_event_b04_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_indg_event_b05_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B05' THEN event_time END)) AS sp_fin_loan_indg_event_b05_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_indg_event_b06_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B06' THEN event_time END)) AS sp_fin_loan_indg_event_b06_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_indg_event_b07_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B07' THEN event_time END)) AS sp_fin_loan_indg_event_b07_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_indg_event_b08_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B08' THEN event_time END)) AS sp_fin_loan_indg_event_b08_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_indg_event_b09_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B09' THEN event_time END)) AS sp_fin_loan_indg_event_b09_remote_dura_d_beforep_360d,
        datediff(back_date, MAX(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_indg_event_b10_recent_dura_d_beforep_360d,
        datediff(back_date, MIN(CASE WHEN flag_360d = 1 AND ind_tag='indG' AND event_type='B10' THEN event_time END)) AS sp_fin_loan_indg_event_b10_remote_dura_d_beforep_360d
    FROM pre_distinct
    GROUP BY mobile_md5, back_date
),aggregated_data AS (
    SELECT
        es.*,
        pcs.*
    FROM event_stats es
    LEFT JOIN plat_cnt_stats pcs
    ON es.mobile_md5 = pcs.mobile_md5 AND es.back_date = pcs.back_date
)
SELECT
   *,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b01_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b02_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b03_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b04_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b05_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b06_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b07_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b08_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b09_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_event_b10_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_inda_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_inda_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_indb_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_indb_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_indc_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_indc_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_indd_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_indd_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_inde_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_inde_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_indf_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_indf_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_15d = 0 THEN 0 ELSE sp_fin_loan_indg_times_15d / sp_fin_loan_total_times_15d END, 6) AS sp_fin_loan_indg_ratio_total_15d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b01_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b02_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b03_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b04_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b05_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b06_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b07_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b08_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b09_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_event_b10_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_inda_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_indb_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_indc_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_indd_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_indd_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_inde_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_indf_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_times_30d / sp_fin_loan_total_times_30d END, 6) AS sp_fin_loan_indg_ratio_total_30d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b01_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b02_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b03_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b04_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b05_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b06_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b07_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b08_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b09_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_event_b10_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_inda_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_inda_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_indb_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_indb_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_indc_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_indc_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_indd_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_indd_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_inde_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_inde_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_indf_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_indf_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_60d = 0 THEN 0 ELSE sp_fin_loan_indg_times_60d / sp_fin_loan_total_times_60d END, 6) AS sp_fin_loan_indg_ratio_total_60d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b01_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b02_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b03_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b04_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b05_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b06_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b07_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b08_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b09_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_event_b10_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_inda_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_indb_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_indc_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_indd_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_indd_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_inde_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_indf_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_times_90d / sp_fin_loan_total_times_90d END, 6) AS sp_fin_loan_indg_ratio_total_90d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b01_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b02_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b03_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b04_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b05_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b06_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b07_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b08_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b09_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_event_b10_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_inda_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_inda_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_indb_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_indb_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_indc_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_indc_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_indd_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_indd_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_inde_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_inde_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_indf_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_indf_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_180d = 0 THEN 0 ELSE sp_fin_loan_indg_times_180d / sp_fin_loan_total_times_180d END, 6) AS sp_fin_loan_indg_ratio_total_180d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b01_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b02_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b03_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b04_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b05_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b06_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b07_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b08_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b09_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_event_b10_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_inda_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_indb_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_indc_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_indd_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_indd_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_inde_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_indf_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_total_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_times_360d / sp_fin_loan_total_times_360d END, 6) AS sp_fin_loan_indg_ratio_total_360d,
    ROUND(CASE WHEN sp_fin_loan_event_b01_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_15d / sp_fin_loan_event_b01_times_30d END, 6) AS sp_fin_loan_event_b01_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b02_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_15d / sp_fin_loan_event_b02_times_30d END, 6) AS sp_fin_loan_event_b02_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b03_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_15d / sp_fin_loan_event_b03_times_30d END, 6) AS sp_fin_loan_event_b03_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b04_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_15d / sp_fin_loan_event_b04_times_30d END, 6) AS sp_fin_loan_event_b04_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b05_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_15d / sp_fin_loan_event_b05_times_30d END, 6) AS sp_fin_loan_event_b05_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b06_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_15d / sp_fin_loan_event_b06_times_30d END, 6) AS sp_fin_loan_event_b06_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b07_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_15d / sp_fin_loan_event_b07_times_30d END, 6) AS sp_fin_loan_event_b07_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b08_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_15d / sp_fin_loan_event_b08_times_30d END, 6) AS sp_fin_loan_event_b08_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b09_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_15d / sp_fin_loan_event_b09_times_30d END, 6) AS sp_fin_loan_event_b09_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b10_times_30d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_15d / sp_fin_loan_event_b10_times_30d END, 6) AS sp_fin_loan_event_b10_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b01_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b01_times_15d / sp_fin_loan_inda_event_b01_times_30d END, 6) AS sp_fin_loan_inda_event_b01_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b02_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b02_times_15d / sp_fin_loan_inda_event_b02_times_30d END, 6) AS sp_fin_loan_inda_event_b02_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b03_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b03_times_15d / sp_fin_loan_inda_event_b03_times_30d END, 6) AS sp_fin_loan_inda_event_b03_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b04_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b04_times_15d / sp_fin_loan_inda_event_b04_times_30d END, 6) AS sp_fin_loan_inda_event_b04_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b05_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b05_times_15d / sp_fin_loan_inda_event_b05_times_30d END, 6) AS sp_fin_loan_inda_event_b05_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b06_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b06_times_15d / sp_fin_loan_inda_event_b06_times_30d END, 6) AS sp_fin_loan_inda_event_b06_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b07_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b07_times_15d / sp_fin_loan_inda_event_b07_times_30d END, 6) AS sp_fin_loan_inda_event_b07_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b08_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b08_times_15d / sp_fin_loan_inda_event_b08_times_30d END, 6) AS sp_fin_loan_inda_event_b08_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b09_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b09_times_15d / sp_fin_loan_inda_event_b09_times_30d END, 6) AS sp_fin_loan_inda_event_b09_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b10_times_30d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b10_times_15d / sp_fin_loan_inda_event_b10_times_30d END, 6) AS sp_fin_loan_inda_event_b10_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b01_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b01_times_15d / sp_fin_loan_indb_event_b01_times_30d END, 6) AS sp_fin_loan_indb_event_b01_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b02_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b02_times_15d / sp_fin_loan_indb_event_b02_times_30d END, 6) AS sp_fin_loan_indb_event_b02_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b03_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b03_times_15d / sp_fin_loan_indb_event_b03_times_30d END, 6) AS sp_fin_loan_indb_event_b03_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b04_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b04_times_15d / sp_fin_loan_indb_event_b04_times_30d END, 6) AS sp_fin_loan_indb_event_b04_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b05_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b05_times_15d / sp_fin_loan_indb_event_b05_times_30d END, 6) AS sp_fin_loan_indb_event_b05_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b06_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b06_times_15d / sp_fin_loan_indb_event_b06_times_30d END, 6) AS sp_fin_loan_indb_event_b06_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b07_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b07_times_15d / sp_fin_loan_indb_event_b07_times_30d END, 6) AS sp_fin_loan_indb_event_b07_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b08_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b08_times_15d / sp_fin_loan_indb_event_b08_times_30d END, 6) AS sp_fin_loan_indb_event_b08_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b09_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b09_times_15d / sp_fin_loan_indb_event_b09_times_30d END, 6) AS sp_fin_loan_indb_event_b09_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b10_times_30d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b10_times_15d / sp_fin_loan_indb_event_b10_times_30d END, 6) AS sp_fin_loan_indb_event_b10_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b01_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b01_times_15d / sp_fin_loan_indc_event_b01_times_30d END, 6) AS sp_fin_loan_indc_event_b01_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b02_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b02_times_15d / sp_fin_loan_indc_event_b02_times_30d END, 6) AS sp_fin_loan_indc_event_b02_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b03_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b03_times_15d / sp_fin_loan_indc_event_b03_times_30d END, 6) AS sp_fin_loan_indc_event_b03_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b04_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b04_times_15d / sp_fin_loan_indc_event_b04_times_30d END, 6) AS sp_fin_loan_indc_event_b04_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b05_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b05_times_15d / sp_fin_loan_indc_event_b05_times_30d END, 6) AS sp_fin_loan_indc_event_b05_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b06_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b06_times_15d / sp_fin_loan_indc_event_b06_times_30d END, 6) AS sp_fin_loan_indc_event_b06_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b07_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b07_times_15d / sp_fin_loan_indc_event_b07_times_30d END, 6) AS sp_fin_loan_indc_event_b07_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b08_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b08_times_15d / sp_fin_loan_indc_event_b08_times_30d END, 6) AS sp_fin_loan_indc_event_b08_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b09_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b09_times_15d / sp_fin_loan_indc_event_b09_times_30d END, 6) AS sp_fin_loan_indc_event_b09_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b10_times_30d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b10_times_15d / sp_fin_loan_indc_event_b10_times_30d END, 6) AS sp_fin_loan_indc_event_b10_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b01_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b01_times_15d / sp_fin_loan_inde_event_b01_times_30d END, 6) AS sp_fin_loan_inde_event_b01_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b02_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b02_times_15d / sp_fin_loan_inde_event_b02_times_30d END, 6) AS sp_fin_loan_inde_event_b02_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b03_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b03_times_15d / sp_fin_loan_inde_event_b03_times_30d END, 6) AS sp_fin_loan_inde_event_b03_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b04_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b04_times_15d / sp_fin_loan_inde_event_b04_times_30d END, 6) AS sp_fin_loan_inde_event_b04_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b05_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b05_times_15d / sp_fin_loan_inde_event_b05_times_30d END, 6) AS sp_fin_loan_inde_event_b05_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b06_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b06_times_15d / sp_fin_loan_inde_event_b06_times_30d END, 6) AS sp_fin_loan_inde_event_b06_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b07_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b07_times_15d / sp_fin_loan_inde_event_b07_times_30d END, 6) AS sp_fin_loan_inde_event_b07_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b08_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b08_times_15d / sp_fin_loan_inde_event_b08_times_30d END, 6) AS sp_fin_loan_inde_event_b08_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b09_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b09_times_15d / sp_fin_loan_inde_event_b09_times_30d END, 6) AS sp_fin_loan_inde_event_b09_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b10_times_30d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b10_times_15d / sp_fin_loan_inde_event_b10_times_30d END, 6) AS sp_fin_loan_inde_event_b10_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b01_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b01_times_15d / sp_fin_loan_indf_event_b01_times_30d END, 6) AS sp_fin_loan_indf_event_b01_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b02_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b02_times_15d / sp_fin_loan_indf_event_b02_times_30d END, 6) AS sp_fin_loan_indf_event_b02_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b03_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b03_times_15d / sp_fin_loan_indf_event_b03_times_30d END, 6) AS sp_fin_loan_indf_event_b03_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b04_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b04_times_15d / sp_fin_loan_indf_event_b04_times_30d END, 6) AS sp_fin_loan_indf_event_b04_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b05_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b05_times_15d / sp_fin_loan_indf_event_b05_times_30d END, 6) AS sp_fin_loan_indf_event_b05_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b06_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b06_times_15d / sp_fin_loan_indf_event_b06_times_30d END, 6) AS sp_fin_loan_indf_event_b06_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b07_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b07_times_15d / sp_fin_loan_indf_event_b07_times_30d END, 6) AS sp_fin_loan_indf_event_b07_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b08_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b08_times_15d / sp_fin_loan_indf_event_b08_times_30d END, 6) AS sp_fin_loan_indf_event_b08_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b09_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b09_times_15d / sp_fin_loan_indf_event_b09_times_30d END, 6) AS sp_fin_loan_indf_event_b09_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b10_times_30d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b10_times_15d / sp_fin_loan_indf_event_b10_times_30d END, 6) AS sp_fin_loan_indf_event_b10_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b01_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b01_times_15d / sp_fin_loan_indg_event_b01_times_30d END, 6) AS sp_fin_loan_indg_event_b01_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b02_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b02_times_15d / sp_fin_loan_indg_event_b02_times_30d END, 6) AS sp_fin_loan_indg_event_b02_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b03_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b03_times_15d / sp_fin_loan_indg_event_b03_times_30d END, 6) AS sp_fin_loan_indg_event_b03_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b04_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b04_times_15d / sp_fin_loan_indg_event_b04_times_30d END, 6) AS sp_fin_loan_indg_event_b04_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b05_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b05_times_15d / sp_fin_loan_indg_event_b05_times_30d END, 6) AS sp_fin_loan_indg_event_b05_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b06_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b06_times_15d / sp_fin_loan_indg_event_b06_times_30d END, 6) AS sp_fin_loan_indg_event_b06_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b07_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b07_times_15d / sp_fin_loan_indg_event_b07_times_30d END, 6) AS sp_fin_loan_indg_event_b07_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b08_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b08_times_15d / sp_fin_loan_indg_event_b08_times_30d END, 6) AS sp_fin_loan_indg_event_b08_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b09_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b09_times_15d / sp_fin_loan_indg_event_b09_times_30d END, 6) AS sp_fin_loan_indg_event_b09_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b10_times_30d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b10_times_15d / sp_fin_loan_indg_event_b10_times_30d END, 6) AS sp_fin_loan_indg_event_b10_ratio_15to30d,
    ROUND(CASE WHEN sp_fin_loan_event_b01_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_30d / sp_fin_loan_event_b01_times_90d END, 6) AS sp_fin_loan_event_b01_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b02_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_30d / sp_fin_loan_event_b02_times_90d END, 6) AS sp_fin_loan_event_b02_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b03_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_30d / sp_fin_loan_event_b03_times_90d END, 6) AS sp_fin_loan_event_b03_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b04_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_30d / sp_fin_loan_event_b04_times_90d END, 6) AS sp_fin_loan_event_b04_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b05_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_30d / sp_fin_loan_event_b05_times_90d END, 6) AS sp_fin_loan_event_b05_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b06_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_30d / sp_fin_loan_event_b06_times_90d END, 6) AS sp_fin_loan_event_b06_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b07_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_30d / sp_fin_loan_event_b07_times_90d END, 6) AS sp_fin_loan_event_b07_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b08_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_30d / sp_fin_loan_event_b08_times_90d END, 6) AS sp_fin_loan_event_b08_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b09_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_30d / sp_fin_loan_event_b09_times_90d END, 6) AS sp_fin_loan_event_b09_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b10_times_90d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_30d / sp_fin_loan_event_b10_times_90d END, 6) AS sp_fin_loan_event_b10_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b01_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b01_times_30d / sp_fin_loan_inda_event_b01_times_90d END, 6) AS sp_fin_loan_inda_event_b01_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b02_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b02_times_30d / sp_fin_loan_inda_event_b02_times_90d END, 6) AS sp_fin_loan_inda_event_b02_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b03_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b03_times_30d / sp_fin_loan_inda_event_b03_times_90d END, 6) AS sp_fin_loan_inda_event_b03_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b04_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b04_times_30d / sp_fin_loan_inda_event_b04_times_90d END, 6) AS sp_fin_loan_inda_event_b04_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b05_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b05_times_30d / sp_fin_loan_inda_event_b05_times_90d END, 6) AS sp_fin_loan_inda_event_b05_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b06_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b06_times_30d / sp_fin_loan_inda_event_b06_times_90d END, 6) AS sp_fin_loan_inda_event_b06_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b07_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b07_times_30d / sp_fin_loan_inda_event_b07_times_90d END, 6) AS sp_fin_loan_inda_event_b07_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b08_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b08_times_30d / sp_fin_loan_inda_event_b08_times_90d END, 6) AS sp_fin_loan_inda_event_b08_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b09_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b09_times_30d / sp_fin_loan_inda_event_b09_times_90d END, 6) AS sp_fin_loan_inda_event_b09_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b10_times_90d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b10_times_30d / sp_fin_loan_inda_event_b10_times_90d END, 6) AS sp_fin_loan_inda_event_b10_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b01_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b01_times_30d / sp_fin_loan_indb_event_b01_times_90d END, 6) AS sp_fin_loan_indb_event_b01_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b02_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b02_times_30d / sp_fin_loan_indb_event_b02_times_90d END, 6) AS sp_fin_loan_indb_event_b02_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b03_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b03_times_30d / sp_fin_loan_indb_event_b03_times_90d END, 6) AS sp_fin_loan_indb_event_b03_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b04_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b04_times_30d / sp_fin_loan_indb_event_b04_times_90d END, 6) AS sp_fin_loan_indb_event_b04_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b05_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b05_times_30d / sp_fin_loan_indb_event_b05_times_90d END, 6) AS sp_fin_loan_indb_event_b05_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b06_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b06_times_30d / sp_fin_loan_indb_event_b06_times_90d END, 6) AS sp_fin_loan_indb_event_b06_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b07_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b07_times_30d / sp_fin_loan_indb_event_b07_times_90d END, 6) AS sp_fin_loan_indb_event_b07_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b08_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b08_times_30d / sp_fin_loan_indb_event_b08_times_90d END, 6) AS sp_fin_loan_indb_event_b08_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b09_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b09_times_30d / sp_fin_loan_indb_event_b09_times_90d END, 6) AS sp_fin_loan_indb_event_b09_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b10_times_90d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b10_times_30d / sp_fin_loan_indb_event_b10_times_90d END, 6) AS sp_fin_loan_indb_event_b10_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b01_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b01_times_30d / sp_fin_loan_indc_event_b01_times_90d END, 6) AS sp_fin_loan_indc_event_b01_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b02_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b02_times_30d / sp_fin_loan_indc_event_b02_times_90d END, 6) AS sp_fin_loan_indc_event_b02_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b03_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b03_times_30d / sp_fin_loan_indc_event_b03_times_90d END, 6) AS sp_fin_loan_indc_event_b03_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b04_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b04_times_30d / sp_fin_loan_indc_event_b04_times_90d END, 6) AS sp_fin_loan_indc_event_b04_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b05_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b05_times_30d / sp_fin_loan_indc_event_b05_times_90d END, 6) AS sp_fin_loan_indc_event_b05_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b06_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b06_times_30d / sp_fin_loan_indc_event_b06_times_90d END, 6) AS sp_fin_loan_indc_event_b06_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b07_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b07_times_30d / sp_fin_loan_indc_event_b07_times_90d END, 6) AS sp_fin_loan_indc_event_b07_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b08_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b08_times_30d / sp_fin_loan_indc_event_b08_times_90d END, 6) AS sp_fin_loan_indc_event_b08_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b09_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b09_times_30d / sp_fin_loan_indc_event_b09_times_90d END, 6) AS sp_fin_loan_indc_event_b09_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b10_times_90d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b10_times_30d / sp_fin_loan_indc_event_b10_times_90d END, 6) AS sp_fin_loan_indc_event_b10_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b01_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b01_times_30d / sp_fin_loan_inde_event_b01_times_90d END, 6) AS sp_fin_loan_inde_event_b01_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b02_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b02_times_30d / sp_fin_loan_inde_event_b02_times_90d END, 6) AS sp_fin_loan_inde_event_b02_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b03_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b03_times_30d / sp_fin_loan_inde_event_b03_times_90d END, 6) AS sp_fin_loan_inde_event_b03_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b04_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b04_times_30d / sp_fin_loan_inde_event_b04_times_90d END, 6) AS sp_fin_loan_inde_event_b04_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b05_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b05_times_30d / sp_fin_loan_inde_event_b05_times_90d END, 6) AS sp_fin_loan_inde_event_b05_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b06_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b06_times_30d / sp_fin_loan_inde_event_b06_times_90d END, 6) AS sp_fin_loan_inde_event_b06_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b07_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b07_times_30d / sp_fin_loan_inde_event_b07_times_90d END, 6) AS sp_fin_loan_inde_event_b07_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b08_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b08_times_30d / sp_fin_loan_inde_event_b08_times_90d END, 6) AS sp_fin_loan_inde_event_b08_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b09_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b09_times_30d / sp_fin_loan_inde_event_b09_times_90d END, 6) AS sp_fin_loan_inde_event_b09_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b10_times_90d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b10_times_30d / sp_fin_loan_inde_event_b10_times_90d END, 6) AS sp_fin_loan_inde_event_b10_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b01_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b01_times_30d / sp_fin_loan_indf_event_b01_times_90d END, 6) AS sp_fin_loan_indf_event_b01_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b02_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b02_times_30d / sp_fin_loan_indf_event_b02_times_90d END, 6) AS sp_fin_loan_indf_event_b02_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b03_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b03_times_30d / sp_fin_loan_indf_event_b03_times_90d END, 6) AS sp_fin_loan_indf_event_b03_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b04_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b04_times_30d / sp_fin_loan_indf_event_b04_times_90d END, 6) AS sp_fin_loan_indf_event_b04_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b05_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b05_times_30d / sp_fin_loan_indf_event_b05_times_90d END, 6) AS sp_fin_loan_indf_event_b05_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b06_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b06_times_30d / sp_fin_loan_indf_event_b06_times_90d END, 6) AS sp_fin_loan_indf_event_b06_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b07_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b07_times_30d / sp_fin_loan_indf_event_b07_times_90d END, 6) AS sp_fin_loan_indf_event_b07_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b08_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b08_times_30d / sp_fin_loan_indf_event_b08_times_90d END, 6) AS sp_fin_loan_indf_event_b08_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b09_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b09_times_30d / sp_fin_loan_indf_event_b09_times_90d END, 6) AS sp_fin_loan_indf_event_b09_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b10_times_90d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b10_times_30d / sp_fin_loan_indf_event_b10_times_90d END, 6) AS sp_fin_loan_indf_event_b10_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b01_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b01_times_30d / sp_fin_loan_indg_event_b01_times_90d END, 6) AS sp_fin_loan_indg_event_b01_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b02_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b02_times_30d / sp_fin_loan_indg_event_b02_times_90d END, 6) AS sp_fin_loan_indg_event_b02_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b03_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b03_times_30d / sp_fin_loan_indg_event_b03_times_90d END, 6) AS sp_fin_loan_indg_event_b03_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b04_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b04_times_30d / sp_fin_loan_indg_event_b04_times_90d END, 6) AS sp_fin_loan_indg_event_b04_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b05_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b05_times_30d / sp_fin_loan_indg_event_b05_times_90d END, 6) AS sp_fin_loan_indg_event_b05_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b06_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b06_times_30d / sp_fin_loan_indg_event_b06_times_90d END, 6) AS sp_fin_loan_indg_event_b06_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b07_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b07_times_30d / sp_fin_loan_indg_event_b07_times_90d END, 6) AS sp_fin_loan_indg_event_b07_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b08_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b08_times_30d / sp_fin_loan_indg_event_b08_times_90d END, 6) AS sp_fin_loan_indg_event_b08_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b09_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b09_times_30d / sp_fin_loan_indg_event_b09_times_90d END, 6) AS sp_fin_loan_indg_event_b09_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b10_times_90d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b10_times_30d / sp_fin_loan_indg_event_b10_times_90d END, 6) AS sp_fin_loan_indg_event_b10_ratio_30to90d,
    ROUND(CASE WHEN sp_fin_loan_event_b01_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b01_times_60d / sp_fin_loan_event_b01_times_360d END, 6) AS sp_fin_loan_event_b01_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b02_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b02_times_60d / sp_fin_loan_event_b02_times_360d END, 6) AS sp_fin_loan_event_b02_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b03_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b03_times_60d / sp_fin_loan_event_b03_times_360d END, 6) AS sp_fin_loan_event_b03_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b04_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b04_times_60d / sp_fin_loan_event_b04_times_360d END, 6) AS sp_fin_loan_event_b04_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b05_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b05_times_60d / sp_fin_loan_event_b05_times_360d END, 6) AS sp_fin_loan_event_b05_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b06_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b06_times_60d / sp_fin_loan_event_b06_times_360d END, 6) AS sp_fin_loan_event_b06_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b07_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b07_times_60d / sp_fin_loan_event_b07_times_360d END, 6) AS sp_fin_loan_event_b07_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b08_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b08_times_60d / sp_fin_loan_event_b08_times_360d END, 6) AS sp_fin_loan_event_b08_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b09_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b09_times_60d / sp_fin_loan_event_b09_times_360d END, 6) AS sp_fin_loan_event_b09_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_event_b10_times_360d = 0 THEN 0 ELSE sp_fin_loan_event_b10_times_60d / sp_fin_loan_event_b10_times_360d END, 6) AS sp_fin_loan_event_b10_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b01_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b01_times_60d / sp_fin_loan_inda_event_b01_times_360d END, 6) AS sp_fin_loan_inda_event_b01_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b02_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b02_times_60d / sp_fin_loan_inda_event_b02_times_360d END, 6) AS sp_fin_loan_inda_event_b02_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b03_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b03_times_60d / sp_fin_loan_inda_event_b03_times_360d END, 6) AS sp_fin_loan_inda_event_b03_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b04_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b04_times_60d / sp_fin_loan_inda_event_b04_times_360d END, 6) AS sp_fin_loan_inda_event_b04_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b05_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b05_times_60d / sp_fin_loan_inda_event_b05_times_360d END, 6) AS sp_fin_loan_inda_event_b05_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b06_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b06_times_60d / sp_fin_loan_inda_event_b06_times_360d END, 6) AS sp_fin_loan_inda_event_b06_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b07_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b07_times_60d / sp_fin_loan_inda_event_b07_times_360d END, 6) AS sp_fin_loan_inda_event_b07_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b08_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b08_times_60d / sp_fin_loan_inda_event_b08_times_360d END, 6) AS sp_fin_loan_inda_event_b08_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b09_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b09_times_60d / sp_fin_loan_inda_event_b09_times_360d END, 6) AS sp_fin_loan_inda_event_b09_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inda_event_b10_times_360d = 0 THEN 0 ELSE sp_fin_loan_inda_event_b10_times_60d / sp_fin_loan_inda_event_b10_times_360d END, 6) AS sp_fin_loan_inda_event_b10_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b01_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b01_times_60d / sp_fin_loan_indb_event_b01_times_360d END, 6) AS sp_fin_loan_indb_event_b01_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b02_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b02_times_60d / sp_fin_loan_indb_event_b02_times_360d END, 6) AS sp_fin_loan_indb_event_b02_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b03_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b03_times_60d / sp_fin_loan_indb_event_b03_times_360d END, 6) AS sp_fin_loan_indb_event_b03_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b04_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b04_times_60d / sp_fin_loan_indb_event_b04_times_360d END, 6) AS sp_fin_loan_indb_event_b04_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b05_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b05_times_60d / sp_fin_loan_indb_event_b05_times_360d END, 6) AS sp_fin_loan_indb_event_b05_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b06_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b06_times_60d / sp_fin_loan_indb_event_b06_times_360d END, 6) AS sp_fin_loan_indb_event_b06_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b07_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b07_times_60d / sp_fin_loan_indb_event_b07_times_360d END, 6) AS sp_fin_loan_indb_event_b07_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b08_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b08_times_60d / sp_fin_loan_indb_event_b08_times_360d END, 6) AS sp_fin_loan_indb_event_b08_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b09_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b09_times_60d / sp_fin_loan_indb_event_b09_times_360d END, 6) AS sp_fin_loan_indb_event_b09_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indb_event_b10_times_360d = 0 THEN 0 ELSE sp_fin_loan_indb_event_b10_times_60d / sp_fin_loan_indb_event_b10_times_360d END, 6) AS sp_fin_loan_indb_event_b10_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b01_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b01_times_60d / sp_fin_loan_indc_event_b01_times_360d END, 6) AS sp_fin_loan_indc_event_b01_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b02_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b02_times_60d / sp_fin_loan_indc_event_b02_times_360d END, 6) AS sp_fin_loan_indc_event_b02_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b03_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b03_times_60d / sp_fin_loan_indc_event_b03_times_360d END, 6) AS sp_fin_loan_indc_event_b03_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b04_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b04_times_60d / sp_fin_loan_indc_event_b04_times_360d END, 6) AS sp_fin_loan_indc_event_b04_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b05_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b05_times_60d / sp_fin_loan_indc_event_b05_times_360d END, 6) AS sp_fin_loan_indc_event_b05_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b06_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b06_times_60d / sp_fin_loan_indc_event_b06_times_360d END, 6) AS sp_fin_loan_indc_event_b06_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b07_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b07_times_60d / sp_fin_loan_indc_event_b07_times_360d END, 6) AS sp_fin_loan_indc_event_b07_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b08_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b08_times_60d / sp_fin_loan_indc_event_b08_times_360d END, 6) AS sp_fin_loan_indc_event_b08_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b09_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b09_times_60d / sp_fin_loan_indc_event_b09_times_360d END, 6) AS sp_fin_loan_indc_event_b09_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indc_event_b10_times_360d = 0 THEN 0 ELSE sp_fin_loan_indc_event_b10_times_60d / sp_fin_loan_indc_event_b10_times_360d END, 6) AS sp_fin_loan_indc_event_b10_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b01_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b01_times_60d / sp_fin_loan_inde_event_b01_times_360d END, 6) AS sp_fin_loan_inde_event_b01_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b02_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b02_times_60d / sp_fin_loan_inde_event_b02_times_360d END, 6) AS sp_fin_loan_inde_event_b02_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b03_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b03_times_60d / sp_fin_loan_inde_event_b03_times_360d END, 6) AS sp_fin_loan_inde_event_b03_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b04_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b04_times_60d / sp_fin_loan_inde_event_b04_times_360d END, 6) AS sp_fin_loan_inde_event_b04_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b05_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b05_times_60d / sp_fin_loan_inde_event_b05_times_360d END, 6) AS sp_fin_loan_inde_event_b05_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b06_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b06_times_60d / sp_fin_loan_inde_event_b06_times_360d END, 6) AS sp_fin_loan_inde_event_b06_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b07_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b07_times_60d / sp_fin_loan_inde_event_b07_times_360d END, 6) AS sp_fin_loan_inde_event_b07_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b08_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b08_times_60d / sp_fin_loan_inde_event_b08_times_360d END, 6) AS sp_fin_loan_inde_event_b08_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b09_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b09_times_60d / sp_fin_loan_inde_event_b09_times_360d END, 6) AS sp_fin_loan_inde_event_b09_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_inde_event_b10_times_360d = 0 THEN 0 ELSE sp_fin_loan_inde_event_b10_times_60d / sp_fin_loan_inde_event_b10_times_360d END, 6) AS sp_fin_loan_inde_event_b10_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b01_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b01_times_60d / sp_fin_loan_indf_event_b01_times_360d END, 6) AS sp_fin_loan_indf_event_b01_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b02_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b02_times_60d / sp_fin_loan_indf_event_b02_times_360d END, 6) AS sp_fin_loan_indf_event_b02_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b03_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b03_times_60d / sp_fin_loan_indf_event_b03_times_360d END, 6) AS sp_fin_loan_indf_event_b03_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b04_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b04_times_60d / sp_fin_loan_indf_event_b04_times_360d END, 6) AS sp_fin_loan_indf_event_b04_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b05_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b05_times_60d / sp_fin_loan_indf_event_b05_times_360d END, 6) AS sp_fin_loan_indf_event_b05_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b06_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b06_times_60d / sp_fin_loan_indf_event_b06_times_360d END, 6) AS sp_fin_loan_indf_event_b06_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b07_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b07_times_60d / sp_fin_loan_indf_event_b07_times_360d END, 6) AS sp_fin_loan_indf_event_b07_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b08_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b08_times_60d / sp_fin_loan_indf_event_b08_times_360d END, 6) AS sp_fin_loan_indf_event_b08_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b09_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b09_times_60d / sp_fin_loan_indf_event_b09_times_360d END, 6) AS sp_fin_loan_indf_event_b09_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indf_event_b10_times_360d = 0 THEN 0 ELSE sp_fin_loan_indf_event_b10_times_60d / sp_fin_loan_indf_event_b10_times_360d END, 6) AS sp_fin_loan_indf_event_b10_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b01_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b01_times_60d / sp_fin_loan_indg_event_b01_times_360d END, 6) AS sp_fin_loan_indg_event_b01_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b02_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b02_times_60d / sp_fin_loan_indg_event_b02_times_360d END, 6) AS sp_fin_loan_indg_event_b02_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b03_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b03_times_60d / sp_fin_loan_indg_event_b03_times_360d END, 6) AS sp_fin_loan_indg_event_b03_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b04_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b04_times_60d / sp_fin_loan_indg_event_b04_times_360d END, 6) AS sp_fin_loan_indg_event_b04_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b05_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b05_times_60d / sp_fin_loan_indg_event_b05_times_360d END, 6) AS sp_fin_loan_indg_event_b05_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b06_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b06_times_60d / sp_fin_loan_indg_event_b06_times_360d END, 6) AS sp_fin_loan_indg_event_b06_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b07_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b07_times_60d / sp_fin_loan_indg_event_b07_times_360d END, 6) AS sp_fin_loan_indg_event_b07_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b08_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b08_times_60d / sp_fin_loan_indg_event_b08_times_360d END, 6) AS sp_fin_loan_indg_event_b08_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b09_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b09_times_60d / sp_fin_loan_indg_event_b09_times_360d END, 6) AS sp_fin_loan_indg_event_b09_ratio_60to360d,
    ROUND(CASE WHEN sp_fin_loan_indg_event_b10_times_360d = 0 THEN 0 ELSE sp_fin_loan_indg_event_b10_times_60d / sp_fin_loan_indg_event_b10_times_360d END, 6) AS sp_fin_loan_indg_event_b10_ratio_60to360d
FROM aggregated_data

